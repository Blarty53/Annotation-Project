<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Annotation</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
<!-- Mobile hamburger -->
<div class="mobile-header">
    <span class="material-icons menu-icon" onclick="toggleSidebar()">menu</span>
    <span class="site-title">Annotation Project</span>
</div>

<!-- Sidebar -->
<nav id="sidebar">
    <div class="sidebar-header">
        <h2>Annotation Project</h2>
    </div>

    <ul class="nav-links">
        <li><a href="index.html"><span class="material-icons">home</span> Home</a></li>
        <li><a href="index.html#search"><span class="material-icons">search</span> Search</a></li>
        <li><a href="submission.html"><span class="material-icons">add_circle</span> Submit URL</a></li>
        <li><a href="pending.html"><span class="material-icons">schedule</span> Pending</a></li>
        <li><a href="annotations.html"><span class="material-icons">library_books</span> All Annotations</a></li>
        <li><a href="bookmarklet.html"><span class="material-icons">bookmark</span> Bookmarklet</a></li>
    </ul>

    <div class="theme-toggle">
        <label>Theme:</label>
        <select id="themeSelect" onchange="setTheme(this.value)">
            <option value="system">System</option>
            <option value="light">Light</option>
            <option value="dark">Dark</option>
        </select>
    </div>
</nav>

<!-- Overlay for mobile -->
<div id="overlay" onclick="toggleSidebar()"></div>

<!-- Page content wrapper -->
<div id="content">

    
<header>
    <h1>Annotation</h1>
    <p>Permanent, evidence‑based context.</p>
</header>

<div id="annotation"></div>

<footer>
    <p>© 2026 Annotation Project</p>
</footer>

<script>
function toggleSidebar() {
    document.getElementById("sidebar").classList.toggle("open");
    document.getElementById("overlay").classList.toggle("show");
}

function setTheme(mode) {
    localStorage.setItem("theme", mode);
    applyTheme();
}

function applyTheme() {
    const saved = localStorage.getItem("theme") || "system";
    document.getElementById("themeSelect").value = saved;

    if (saved === "light") {
        document.body.classList.remove("dark-theme");
    } else if (saved === "dark") {
        document.body.classList.add("dark-theme");
    } else {
        const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        document.body.classList.toggle("dark-theme", prefersDark);
    }
}

applyTheme();
    
let annotations = [];

async function loadAnnotation() {
    const params = new URLSearchParams(window.location.search);
    const id = parseInt(params.get('id'));

    const res = await fetch('annotations.json');
    annotations = await res.json();

    const item = annotations.find(a => a.id === id);

    const container = document.getElementById('annotation');

    if (!item) {
        container.innerHTML = '<div class="no-results">Annotation not found.</div>';
        return;
    }

    container.innerHTML = `
        <div class="annotation">
            <h2>${item.claim}</h2>
            <p><strong>Verdict:</strong> ${item.verdict}</p>
            <p><strong>Why:</strong> ${item.why}</p>
            <p><strong>Original Page:</strong> <a href="${item.original_link}" target="_blank">View Original</a></p>
            <p><strong>Archived Link:</strong> <a href="${item.archived_link}" target="_blank">View Archive</a></p>
            <p><strong>Hypothesis Annotation:</strong> <a href="${item.hypothesis_link}" target="_blank">View on Hypothes.is</a></p>
            <p><strong>Timestamp:</strong> ${item.timestamp}</p>
            ${item.screenshot ? `<img src="${item.screenshot}" style="max-width:100%; margin-top:20px; border:1px solid #ccc; border-radius:6px;">` : ''}
        </div>
    `;
}

loadAnnotation();
</script>

</div> <!-- end content wrapper -->
</body>
</html>
